<div class="ui very padded raised segment animated fadeInUp">
  {{#if this.pendingApplications}}
    <h2 class="ui clearfix header">
      Applicants Awaiting Review
    </h2>

    <div class="right aligned text">
      {{#if this.selectedApplications}}
        <a href="#" class="ui small green button" {{action (pipe
            (action this.openModal this.confirmInjectModalId "inject")
            (action this.injectConfirmed this.selectedApplications)
          )}}
        >
          Move Selected To Pipeline
        </a>

        <a href="#" class="ui small orange button" {{action (pipe
            (action this.openModal this.disqualifyModalId "disqualify")
            (action "disqualifyCandidate" this.selectedApplications)
            (action "deselectAllApplications")
          )}}
        >
          Disqualify Selected
        </a>
      {{/if}}

      {{#if this.showingAllPending}}
        <a href="#" class="ui small button" {{action "selectAllApplications"}}>
          Select All
        </a>
        <a href="#" class="ui small negative button" {{action "deselectAllApplications"}}>
          Deselect All
        </a>
      {{/if}}
    </div>

    <div class="ui selectable divided items {{if (not (or this.showingAllPending (lt this.pendingApplications.length 4))) "fade-unless-hovered"}}">
      {{#each
        (if (not this.showingAllPending)
          (take 3 this.pendingApplications)
          this.pendingApplications
        )
        as |application|
      }}
        {{list-item/pending-applicant
          application
          selected=this.selectedApplications
          onSelectChange=(action "selectApplication")
        }}
      {{/each}}
    </div>

    {{#if (gt this.pendingApplications.length 3)}}
      <h4 class="center aligned text">
        <a href="#" class="" {{action "toggleProperty" "showingAllPending"}}>
          {{#if this.showingAllPending}}
            Show Less <i class="angle up icon"></i>
          {{else}}
            Show More <i class="angle down icon"></i>
          {{/if}}
        </a>
      </h4>
    {{/if}}

    <div class="ui divider"></div>
  {{/if}}

  <h2 class="ui clearfix header">
    Your Recruiting Pipeline

    <small class="right floated small text">
      <a href="#" {{action this.toggleProperty "showDisqualified"}}>
        {{if this.showDisqualified "Hide" "Show"}} Disqualified Applicants
      </a>
    </small>

    {{#modals/ats-add-applicant
      class="ui center aligned text"
      model=this.model
      pipelines=this.model.pipeline
      onNotify=(action "onNotify")
      refresh=(action "refreshModel") as |openAddModal|
    }}
      <a href="#" class="ats__action--add-applicant smaller text" {{action openAddModal}}>
        {{ember-tooltip
          side="bottom"
          popperContainer="body"
          text="Manually add applicant"}}
        <i class="ui plus icon"></i> Add Applicant
      </a>
    {{/modals/ats-add-applicant}}
  </h2>

  {{#confirm-modal
    confirmContent="Are you sure you want to hire and onboard this candidate?"
    as |confirm|}}
    {{card-pipeline
      this.activeCandidates
      newScheduledMeeting=this.newScheduledMeeting
      pipeline=this.model.pipeline
      onDisqualify=(action (pipe
        (action this.set "appInDisqualifyConfirm")
        (action this.openModal this.disqualifyModalId "disqualify")
        (action "disqualifyCandidate" this.appInDisqualifyConfirm)
      ))
      onUnDisqualify=(action "unDisqualifyCandidate")
      onUnHire=(action "unSetHire")
      onSchedule=(action (pipe
        (action this.set "appInScheduler")
        (action this.resetMeeting)
        (action this.openModal this.schedulerModalId "scheduler")
        (action this.saveMeeting)
      ))
      onOnboardCandidate=(action (pipe
        (action confirm)
        (action this.beginOnboarding)
      ))
      onLinkSharing=(action (pipe
        (action this.set "appInLinkSharing")
        (action this.openModal this.linkSharingModalId "linkSharing")
      ))
      onAddLabel=(action (pipe
        (action this.set "appInAddLabels")
        (action this.openModal this.labelsModalId "addLabel")
        (action "saveApplicationLabels")
      ))
    }}
  {{/confirm-modal}}

  {{modals/ats-confirm-inject
    applicants=this.selectedApplications
    modalId=this.confirmInjectModalId
    onResponse=(action "modalResponse" "inject")}}

  {{modals/ats-disqualify
    model=this.appInDisqualifyConfirm
    modalId=this.disqualifyModalId
    onResponse=(action "modalResponse" "disqualify")}}

  {{modals/ats-scheduler
    this.appInScheduler
    this.currentMeeting
    modalId=this.schedulerModalId
    availableOrganizers=this.model.employees
    onResponse=(action "modalResponse" "scheduler")}}

  {{modals/ats-link-sharing
    this.appInLinkSharing
    modalId=this.linkSharingModalId
    onResponse=(action "modalResponse" "linkSharing")}}

  {{modals/ats-add-label
    this.appInAddLabels
    modalId=this.labelsModalId
    onResponse=(action "modalResponse" "addLabel")}}
</div>
