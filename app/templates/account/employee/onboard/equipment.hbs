<h2 class="ui horizontal divider header">
  Assets
</h2>

<form class="ui form" {{action "saveAndContinue" on="submit"}}>
  <div class="ui basic segment">
    <div class="right aligned text">
      {{#input/equipment-picker
        assignableAssets=this.splitAssets.remainingAssets
        suggestedAssets=this.splitAssets.suggestedAssets
        onSelect=(action "selectAsset")
        onCreate=(action "createAsset")
        newAssetCategory=(action "newAssetCategory")}}
        <h3 class="ui header"><a href="#"><i class="plus icon"></i></a></h3>
      {{/input/equipment-picker}}
    </div>

    <div class="ui relaxed divided list">
      {{#each this.groupedAssignedAssets as |assetGroup|}}
        <h4 class="header">
          {{#if assetGroup.asset.icon}}
            <i class="{{assetGroup.asset.icon}} icon"></i>
          {{/if}}
          {{assetGroup.asset.name}}
        </h4>
        {{#each assetGroup.assets as |asset|}}
          <div class="item">
            {{asset.identifier}}
            <span class="right floated">
              <a href="#" class="text-danger" {{action "unassignAsset" asset}}>
                {{ember-tooltip
                  side="top"
                  popperContainer="body"
                  text="Unassign asset"}}
                <i class="minus icon"></i>
              </a>
            </span>
          </div>
        {{/each}}
      {{else}}
        <h2 class="ui center aligned header">
          No assets assigned. Click "+" to assign some! <i class="right floated clockwise rotated reply icon"></i>
        </h2>
      {{/each}}
    </div>
  </div>

  <div class="ui divider"></div>
  {{#form/action-button type="submit" class="ui huge fluid green button" loading=this.working}}Next{{/form/action-button}}
</form>

<div id="modal__new-asset--placeholder">
  {{#ui-modal id="modal__new-asset" name="new-asset" class="new-asset" detachable=true}}
    <i class="cancel close icon"></i>
    <div class="header">
      Creating a new item in "{{this.pendingAssetItem.asset.name}}" for {{this.model.firstName}}
    </div>
    <div class="content">
      <form class="ui form container">
        <div class="field">
          <label for="asset-identifier">Asset Identifier</label>
          {{input type="text" value=this.pendingAssetItem.identifier id="asset-identifier" placeholder="Unique identifier (VIN, Stock #, RFID)"}}
        </div>

        <div class="field">
          <label for="asset-description">Documents</label>
          <p class="light text">
            Document upload is only available in category view.
            <a href="#"
               {{action "closeAssetModalAndTransition" "account.asset.index.new" this.pendingAssetItem.asset.id}}>
              Go to asset category
            </a>
          </p>
        </div>
        {{#if this.pendingAssetItem.asset.attributes}}
          <div class="ui divider"></div>
          {{#each this.pendingAssetItem.asset.attributes as |attribute|}}
            {{input/custom-field object=this.pendingAssetItem.customFields attribute=attribute}}
          {{/each}}
        {{/if}}
      </form>
    </div>
    <div class="actions">
      <button class="ui red button" {{action "abortAsset"}}>
        Cancel
      </button>
      <button class="ui green right labeled icon button" {{action "saveAsset"}}>
        Create &amp; Assign Asset
        <i class="check icon"></i>
      </button>
    </div>
  {{/ui-modal}}
</div>
