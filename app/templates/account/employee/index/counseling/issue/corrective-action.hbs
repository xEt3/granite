<ConfirmModal @deleteContext={{concat "Corrective Action: " model.type}} as |confirmDelete|>
  <Input::DocumentSelectionModal @title="New Corrective Action Document" @selected={{model.file}} @correctiveAction={{model}} @assignText="Use Document" @singleDoc={{true}} @systemUse={{true}} @autoTag="corrective Action Document" @onSelected={{pipe-action (action (mut model.file)) (action "saveDocument")}} as |selectDocuments|>
    <hgroup>
      <span class="ui header">
        {{#if (await model.actionSeverity)}}
          {{get (await model.actionSeverity) "name"}} on
        {{/if}}
        {{time
          (if this.model.issuedOn this.model.issuedOn this.model.created)
          "MMMM Do YYYY"}}
      </span>
      <UiDropdown @class="item icon top right pointing right floated">
        <i class="wrench icon"></i><i class="dropdown icon"></i>
        <div class="menu">
          <div class="header">Actions</div>
          <a href="#" class="item" {{action selectDocuments}}>
            <i class="folder icon"></i>
            Add a Document
          </a>
          {{#if (and model.followUpOn (not model.resolutionStatusOn))}}
            <a href="#" class="item" {{action (pipe (action "openFollowupModal") (action "saveFollowup"))}}>
              <i class="repeat icon"></i>Follow Up
            </a>
          {{/if}}
          <LinkTo @route="account.employee.index.counseling.issue.corrective-action.edit" class="item">
            <i class="edit icon"></i>Edit
          </LinkTo>
          <div class="text-danger header">Danger Zone</div>
          <a href="#" class="text-danger item" {{action (pipe confirmDelete (action "delete"))}}>
            <i class="trash icon"></i>Delete Record
          </a>
        </div>
      </UiDropdown>
    </hgroup>
  </Input::DocumentSelectionModal>
</ConfirmModal>

<div class="ui divider"></div>
{{outlet}}

<UiModal @name="modal__corrective-action--followup" @id="modal__corrective-action--followup" @class="small form">
  <div class="header">
    Following up to
    {{#if (await this.model.actionSeverity)}}
      {{get (await this.model.actionSeverity) "name"}} on
    {{/if}}
    {{time
      (if this.model.issuedOn this.model.issuedOn this.model.created)
      "MMMM Do YYYY"}}
  </div>
  <div class="content">
    {{quick-form
      this.followupForm
      this.followup
      this
      tagName="div"}}
  </div>
  <div class="actions">
    <button class="ui red button" {{action "respondFollowup" false}}>
      Cancel
    </button>
    <button class="ui primary right labeled icon button" {{action "respondFollowup" true}}>
      Done
      <i class="check icon"></i>
    </button>
  </div>
</UiModal>
